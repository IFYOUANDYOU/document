// pages/wrongTopic/modules/modules.js
let allModules = [
  {
    "id": 2,
    "moduleName": "知识点模块",
    "moduleLevel": 1,
    "parentId": 0,
    "moduleIntroduce": "智能识别错题，并为错题匹配知识点。",
    "pictureModule": "https://xxy-files-develop.oss-cn-shenzhen.aliyuncs.com/yy_error_dev/module/%E7%9F%A5%E8%AF%86%E7%82%B91.png",
    "pictureDetail": "https://xxy-files-develop.oss-cn-shenzhen.aliyuncs.com/yy_error_dev/module/%E7%9F%A5%E8%AF%86%E7%82%B9%402x.png",
    "moduleTopicNumber": null,
    "list": []
  },
  {
    "id": 3,
    "moduleName": "学业人格分析报告模块",
    "moduleLevel": 1,
    "parentId": 0,
    "moduleIntroduce": "多维度全方位剖析学生学习心理，让学生更了解自己",
    "pictureModule": "https://xxy-files-develop.oss-cn-shenzhen.aliyuncs.com/yy_error_dev/module/%E5%AD%A6%E4%B8%9A%E4%BA%BA%E6%A0%BC1.png",
    "pictureDetail": "https://xxy-files-develop.oss-cn-shenzhen.aliyuncs.com/yy_error_dev/module/%E5%AD%A6%E4%B8%9A%E4%BA%BA%E6%A0%BC2.png",
    "moduleTopicNumber": null,
    "list": []
  },
  {
    "id": 4,
    "moduleName": "综合分析模块",
    "moduleLevel": 1,
    "parentId": 0,
    "moduleIntroduce": "统计多科综合成绩情况，让学生更了解自己各科的差距，为学生全面发展指明方向。",
    "pictureModule": "https://xxy-files-develop.oss-cn-shenzhen.aliyuncs.com/yy_error_dev/module/%E7%BB%BC%E5%90%88%E5%88%86%E6%9E%901.png",
    "pictureDetail": "https://xxy-files-develop.oss-cn-shenzhen.aliyuncs.com/yy_error_dev/module/%E7%BB%BC%E5%90%88%E5%88%86%E6%9E%902.png",
    "moduleTopicNumber": null,
    "list": [
      {
        "id": 9,
        "guId": null,
        "moduleName": "概况",
        "createTime": null,
        "moduleLevel": 2,
        "parentId": 4,
        "moduleIntroduce": null,
        "pictureModule": null,
        "pictureDetail": null
      },
      {
        "id": 10,
        "guId": null,
        "moduleName": "各科平均丢分率情况",
        "createTime": null,
        "moduleLevel": 2,
        "parentId": 4,
        "moduleIntroduce": null,
        "pictureModule": null,
        "pictureDetail": null
      }
    ]
  },
  {
    "id": 5,
    "moduleName": "单科分析模块",
    "moduleLevel": 1,
    "parentId": 0,
    "moduleIntroduce": "统计蛋壳成绩情况，让学生清楚自己的成绩变化、难易题掌握情况后，进行针对训练。",
    "pictureModule": "https://xxy-files-develop.oss-cn-shenzhen.aliyuncs.com/yy_error_dev/module/%E7%BB%BC%E5%90%88%E5%88%86%E6%9E%901.png",
    "pictureDetail": "https://xxy-files-develop.oss-cn-shenzhen.aliyuncs.com/yy_error_dev/module/%E7%BB%BC%E5%90%88%E5%88%86%E6%9E%902.png",
    "moduleTopicNumber": null,
    "list": [
      {
        "id": 11,
        "guId": null,
        "moduleName": "概况",
        "createTime": null,
        "moduleLevel": 2,
        "parentId": 5,
        "moduleIntroduce": null,
        "pictureModule": null,
        "pictureDetail": null
      },
      {
        "id": 12,
        "guId": null,
        "moduleName": "成绩趋势",
        "createTime": null,
        "moduleLevel": 2,
        "parentId": 5,
        "moduleIntroduce": null,
        "pictureModule": null,
        "pictureDetail": null
      },
      {
        "id": 13,
        "guId": null,
        "moduleName": "难易题丢分情况",
        "createTime": null,
        "moduleLevel": 2,
        "parentId": 5,
        "moduleIntroduce": null,
        "pictureModule": null,
        "pictureDetail": null
      },
      {
        "id": 14,
        "guId": null,
        "moduleName": "知识点丢分情况",
        "createTime": null,
        "moduleLevel": 2,
        "parentId": 5,
        "moduleIntroduce": null,
        "pictureModule": null,
        "pictureDetail": null
      }
    ]
  },
  {
    "id": 6,
    "moduleName": "学生错题模块",
    "moduleLevel": 1,
    "parentId": 0,
    "moduleIntroduce": "错题一一再现，重练使掌握更牢固，减小再次失分概率。",
    "pictureModule": "https://xxy-files-develop.oss-cn-shenzhen.aliyuncs.com/yy_error_dev/module/%E5%AD%A6%E7%94%9F%E9%94%99%E9%A2%981.png",
    "pictureDetail": "https://xxy-files-develop.oss-cn-shenzhen.aliyuncs.com/yy_error_dev/module/%E5%AD%A6%E7%94%9F%E9%94%99%E9%A2%982.png",
    "moduleTopicNumber": null,
    "list": [
      {
        "id": 15,
        "guId": null,
        "moduleName": "订正区",
        "createTime": null,
        "moduleLevel": 2,
        "parentId": 6,
        "moduleIntroduce": null,
        "pictureModule": null,
        "pictureDetail": null
      },
      {
        "id": 16,
        "guId": null,
        "moduleName": "痕迹保留",
        "createTime": null,
        "moduleLevel": 2,
        "parentId": 6,
        "moduleIntroduce": null,
        "pictureModule": null,
        "pictureDetail": null
      },
      {
        "id": 17,
        "guId": null,
        "moduleName": "单题统计信息",
        "createTime": null,
        "moduleLevel": 2,
        "parentId": 6,
        "moduleIntroduce": null,
        "pictureModule": null,
        "pictureDetail": null
      },
      {
        "id": 18,
        "guId": null,
        "moduleName": "答案跟随错题",
        "createTime": null,
        "moduleLevel": 2,
        "parentId": 6,
        "moduleIntroduce": null,
        "pictureModule": null,
        "pictureDetail": null
      }
    ]
  },
  {
    "id": 7,
    "moduleName": "高频错题模块",
    "moduleLevel": 1,
    "parentId": 0,
    "moduleIntroduce": "班级高频错题一目了然。",
    "pictureModule": "https://xxy-files-develop.oss-cn-shenzhen.aliyuncs.com/yy_error_dev/module/%E9%AB%98%E9%A2%91%E9%94%99%E9%A2%981.png",
    "pictureDetail": "https://xxy-files-develop.oss-cn-shenzhen.aliyuncs.com/yy_error_dev/module/%E9%AB%98%E9%A2%91%E9%94%99%E9%A2%982.png",
    "moduleTopicNumber": null,
    "list": [
      {
        "id": 19,
        "guId": null,
        "moduleName": "订正区",
        "createTime": null,
        "moduleLevel": 2,
        "parentId": 7,
        "moduleIntroduce": null,
        "pictureModule": null,
        "pictureDetail": null
      },
      {
        "id": 20,
        "guId": null,
        "moduleName": "痕迹保留",
        "createTime": null,
        "moduleLevel": 2,
        "parentId": 7,
        "moduleIntroduce": null,
        "pictureModule": null,
        "pictureDetail": null
      },
      {
        "id": 21,
        "guId": null,
        "moduleName": "单题统计信息",
        "createTime": null,
        "moduleLevel": 2,
        "parentId": 7,
        "moduleIntroduce": null,
        "pictureModule": null,
        "pictureDetail": null
      },
      {
        "id": 22,
        "guId": null,
        "moduleName": "答案跟随错题",
        "createTime": null,
        "moduleLevel": 2,
        "parentId": 7,
        "moduleIntroduce": null,
        "pictureModule": null,
        "pictureDetail": null
      }
    ]
  },
  {
    "id": 8,
    "moduleName": "举一反三模块",
    "moduleLevel": 1,
    "parentId": 0,
    "moduleIntroduce": "根据错题，提供3道知识点一致的相似题，帮助学生更牢固的掌握知识点，减少再次丢分的可能。",
    "pictureModule": "https://xxy-files-develop.oss-cn-shenzhen.aliyuncs.com/yy_error_dev/module/%E4%B8%BE%E4%B8%80%E5%8F%8D%E4%B8%891.png",
    "pictureDetail": "https://xxy-files-develop.oss-cn-shenzhen.aliyuncs.com/yy_error_dev/module/%E4%B8%BE%E4%B8%80%E5%8F%8D%E4%B8%892.png",
    "moduleTopicNumber": null,
    "list": []
  }
];
Page({

  /**
   * 页面的初始数据
   */
  data: {
    step: 1,
    allModules: [],
    selectModule: [],
    unSelected: [],
    exampleStatu: false, //是否显示 示例弹窗
    example: {}
  },

  /**
   * 生命周期函数--监听页面加载
   */
  onLoad: function (options) {
    this.setData({
      allModules
    })
    this.initModules(true);
  },

  //init modules
  initModules(state){
    let allModules = this.data.allModules,selectModule = [],unSelected = [];
    if (state){
      unSelected = allModules.filter(item => {
        return item.moduleName == "学业人格分析报告模块";
      });
      selectModule = allModules.filter(item => {
        return item.moduleName != "学业人格分析报告模块";
      });
    }else{

    }
    this.setData({
      unSelected,
      selectModule
    })
  },

  /**
   * 生命周期函数--监听页面初次渲染完成
   */
  onReady: function () {

  },

  /**
   * 生命周期函数--监听页面显示
   */
  onShow: function () {

  },

  //模块选择  选择或删除模块
  bindSelectModule(e){
    const id = e.currentTarget.dataset.id;
    const index = e.currentTarget.dataset.index;
    const tp = e.currentTarget.dataset.tp;
    const name = e.currentTarget.dataset.name;
    const selectModule = this.data.selectModule;
    const unSelected = this.data.unSelected;

    if(name == "学生错题模块") return false;

    if(tp == 1){ //增加 模块
      selectModule.push(unSelected[index]);
      unSelected.splice(index, 1);
    }else{
      unSelected.push(selectModule[index]);
      selectModule.splice(index, 1);
    }
    this.setData({
      selectModule,
      unSelected
    })
  },

  //模块选择完毕 事件
  selectComplete(){
    this.setData({
      step: 2
    })
    wx.setNavigationBarTitle({
      title: '预览配置'
    })
  },

  //模块配置完成
  configModuleComplete(){
        
  },

  //查看 关闭示例
  previewExample(e){
    const tp = e.currentTarget.dataset.tp;
    const item = e.currentTarget.dataset.item;
    let exampleStatu = this.data.exampleStatu;
    let example = this.data.example;
    if(tp == "0"){
      exampleStatu = false;
      example.title = "";
      example.pictureDetail = "";
    }else{
      exampleStatu = true;
      example.title = item.moduleName;
      example.pictureDetail = "/image/wrongs/cover-icon.png"
      //example.pictureDetail = item.pictureDetail;
    }
    this.setData({
      exampleStatu,
      example
    })
  },

  handleModal(title,body,text1,text2,confirm,cancel){
    wx.showModal({
      title: title,
      content: body,
      confirmText: text1,
      cancelText: text2,
      showCancel: text2 != "",
      success (res) {
        if (res.confirm) {
          confirm();
        } else if (res.cancel) {
          cancel();
        }
      }
    })
  },

  /**
   * 生命周期函数--监听页面隐藏
   */
  onHide: function () {

  },

  /**
   * 生命周期函数--监听页面卸载
   */
  onUnload: function () {

  },

  /**
   * 页面相关事件处理函数--监听用户下拉动作
   */
  onPullDownRefresh: function () {

  },

  /**
   * 页面上拉触底事件的处理函数
   */
  onReachBottom: function () {

  },

  /**
   * 用户点击右上角分享
   */
  onShareAppMessage: function () {

  }
})